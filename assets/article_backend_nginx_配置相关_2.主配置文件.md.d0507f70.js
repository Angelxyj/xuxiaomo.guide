import{_ as s,o as n,c as a,Q as l}from"./chunks/framework.ab7e7ee0.js";const b=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[{"level":4,"title":"① 核心模块","slug":"_1-核心模块","link":"#_1-核心模块","children":[]},{"level":4,"title":"② 事件驱动模块","slug":"_2-事件驱动模块","link":"#_2-事件驱动模块","children":[]},{"level":4,"title":"③ HTTP模块","slug":"_3-http模块","link":"#_3-http模块","children":[]},{"level":4,"title":"④ server块","slug":"_4-server块","link":"#_4-server块","children":[]},{"level":4,"title":"⑤ location块","slug":"_5-location块","link":"#_5-location块","children":[]}],"relativePath":"article/backend/nginx/配置相关/2.主配置文件.md","filePath":"article/backend/nginx/配置相关/2.主配置文件.md","lastUpdated":1707839101000}'),p={name:"article/backend/nginx/配置相关/2.主配置文件.md"},e=l(`<p><code>nginx.conf</code></p><p><img src="https://cdn.jsdelivr.net/gh/lijing-2008/PicGo/img/20220111071215.png" alt=""></p><h4 id="_1-核心模块" tabindex="-1">① 核心模块 <a class="header-anchor" href="#_1-核心模块" aria-label="Permalink to &quot;① 核心模块&quot;">​</a></h4><p><code>CoreModule</code></p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nginx</span><span style="color:#E1E4E8;">; </span><span style="color:#6A737D;">#nginx自身的用户信息，目的是安全，不使用系统root账户</span></span>
<span class="line"><span style="color:#B392F0;">woker_processes</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">auto</span><span style="color:#E1E4E8;">; </span><span style="color:#6A737D;">#进程数，一般cpu是几核最多就搞几个</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">error_log</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/var/log/nginx/error.log</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">notice</span><span style="color:#E1E4E8;">; </span><span style="color:#6A737D;">#错误日志</span></span>
<span class="line"><span style="color:#B392F0;">pid</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/var/run/nginx.pid</span><span style="color:#E1E4E8;">; </span><span style="color:#6A737D;">#nginx的进程编号存放路径</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">user</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nginx</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">#nginx自身的用户信息，目的是安全，不使用系统root账户</span></span>
<span class="line"><span style="color:#6F42C1;">woker_processes</span><span style="color:#24292E;"> </span><span style="color:#032F62;">auto</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">#进程数，一般cpu是几核最多就搞几个</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">error_log</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/var/log/nginx/error.log</span><span style="color:#24292E;"> </span><span style="color:#032F62;">notice</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">#错误日志</span></span>
<span class="line"><span style="color:#6F42C1;">pid</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/var/run/nginx.pid</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">#nginx的进程编号存放路径</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_2-事件驱动模块" tabindex="-1">② 事件驱动模块 <a class="header-anchor" href="#_2-事件驱动模块" aria-label="Permalink to &quot;② 事件驱动模块&quot;">​</a></h4><p><code>EventsModule</code> 配置影响nginx服务器或与用户的网络连接。有每个进程的最大连接数，选取哪种事件驱动模型处理连接请求，是否允许同时接受多个网络连接，开启多个网络连接序列化等。</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">events</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#B392F0;">woeker_connections</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1024</span><span style="color:#E1E4E8;">; </span><span style="color:#6A737D;">#并发数</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">events</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6F42C1;">woeker_connections</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1024</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">#并发数</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p>以上两个模块一般只会修改<em><strong>进程数</strong></em>和<em><strong>并发数</strong></em></p></blockquote><h4 id="_3-http模块" tabindex="-1">③ HTTP模块 <a class="header-anchor" href="#_3-http模块" aria-label="Permalink to &quot;③ HTTP模块&quot;">​</a></h4><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">http</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">include</span><span style="color:#E1E4E8;">       </span><span style="color:#9ECBFF;">/etc/nginx/mime.types</span><span style="color:#E1E4E8;">;  </span><span style="color:#6A737D;">#文件--程序</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">default_type</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">application/octet-stream</span><span style="color:#E1E4E8;">; </span><span style="color:#6A737D;">#默认字节流处理方式</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">log_format</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">main</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">&#39;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">                      </span><span style="color:#B392F0;">&#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">                      </span><span style="color:#B392F0;">&#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;</span><span style="color:#E1E4E8;">; </span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">access_log</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">/var/log/nginx/access.log</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">main</span><span style="color:#E1E4E8;">; </span><span style="color:#6A737D;">#访问日志,采用main格式显示</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">sendfile</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">on</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">#tcp_nopush     on;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">keepalive_timeout</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">65</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">#gzip  on;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/nginx/conf.d/</span><span style="color:#79B8FF;">*</span><span style="color:#9ECBFF;">.conf</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">http</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">include</span><span style="color:#24292E;">       </span><span style="color:#032F62;">/etc/nginx/mime.types</span><span style="color:#24292E;">;  </span><span style="color:#6A737D;">#文件--程序</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">default_type</span><span style="color:#24292E;">  </span><span style="color:#032F62;">application/octet-stream</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">#默认字节流处理方式</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">log_format</span><span style="color:#24292E;">  </span><span style="color:#032F62;">main</span><span style="color:#24292E;">  </span><span style="color:#032F62;">&#39;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#39;</span></span>
<span class="line"><span style="color:#24292E;">                      </span><span style="color:#6F42C1;">&#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;</span></span>
<span class="line"><span style="color:#24292E;">                      </span><span style="color:#6F42C1;">&#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;</span><span style="color:#24292E;">; </span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">access_log</span><span style="color:#24292E;">  </span><span style="color:#032F62;">/var/log/nginx/access.log</span><span style="color:#24292E;">  </span><span style="color:#032F62;">main</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">#访问日志,采用main格式显示</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">sendfile</span><span style="color:#24292E;">        </span><span style="color:#032F62;">on</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">#tcp_nopush     on;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">keepalive_timeout</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">65</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">#gzip  on;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/nginx/conf.d/</span><span style="color:#005CC5;">*</span><span style="color:#032F62;">.conf</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>日志相关配置见---[[nginx日志]]</p><h4 id="_4-server块" tabindex="-1">④ server块 <a class="header-anchor" href="#_4-server块" aria-label="Permalink to &quot;④ server块&quot;">​</a></h4><p>可以放在http模块内部或者单独的自定义配置文件配置文件</p><h4 id="_5-location块" tabindex="-1">⑤ location块 <a class="header-anchor" href="#_5-location块" aria-label="Permalink to &quot;⑤ location块&quot;">​</a></h4><p>放在server块中</p>`,16),o=[e];function r(t,c,i,E,y,d){return n(),a("div",null,o)}const _=s(p,[["render",r]]);export{b as __pageData,_ as default};
