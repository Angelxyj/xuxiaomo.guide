import{_ as s,o as n,c as a,Q as l}from"./chunks/framework.25ff06b1.js";const m=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[{"level":2,"title":"一、图标配置","slug":"一、图标配置","link":"#一、图标配置","children":[]},{"level":2,"title":"二、创建系统托盘","slug":"二、创建系统托盘","link":"#二、创建系统托盘","children":[]},{"level":2,"title":"三、配置系统托盘菜单","slug":"三、配置系统托盘菜单","link":"#三、配置系统托盘菜单","children":[]},{"level":2,"title":"四、配置系统应用托盘","slug":"四、配置系统应用托盘","link":"#四、配置系统应用托盘","children":[]},{"level":2,"title":"五、监听托盘菜单点击事件","slug":"五、监听托盘菜单点击事件","link":"#五、监听托盘菜单点击事件","children":[]},{"level":2,"title":"六、更新系统托盘","slug":"六、更新系统托盘","link":"#六、更新系统托盘","children":[{"level":3,"title":"1. 更新菜单项名称","slug":"_1-更新菜单项名称","link":"#_1-更新菜单项名称","children":[]},{"level":3,"title":"2.更新托盘图标","slug":"_2-更新托盘图标","link":"#_2-更新托盘图标","children":[]}]},{"level":2,"title":"七、设置应用后台运行","slug":"七、设置应用后台运行","link":"#七、设置应用后台运行","children":[]}],"relativePath":"article/frontend/tauri/特性/8.系统托盘.md","filePath":"article/frontend/tauri/特性/8.系统托盘.md","lastUpdated":1707839101000}'),p={name:"article/frontend/tauri/特性/8.系统托盘.md"},o=l(`<blockquote><p>系统托盘是什么呢？</p></blockquote><img src="https://gitlab.com/lijing-2008/blogpic/-/raw/main/pictures/2022/12/23_9_1_41_image-20221223090141384.png" alt="image-20221223090141384" style="zoom:50%;"><p>这上面的东西就是系统托盘，使用系统托盘需要分为几步</p><h2 id="一、图标配置" tabindex="-1">一、图标配置 <a class="header-anchor" href="#一、图标配置" aria-label="Permalink to &quot;一、图标配置&quot;">​</a></h2><p>配置<code>tauri.conf.json</code>文件，主要是配置托盘图标的</p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">&quot;tauri&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;systemTray&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;iconPath&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;icons/icon.png&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">&quot;iconAsTemplate&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">true</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">&quot;tauri&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;systemTray&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;iconPath&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;icons/icon.png&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;iconAsTemplate&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">true</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="二、创建系统托盘" tabindex="-1">二、创建系统托盘 <a class="header-anchor" href="#二、创建系统托盘" aria-label="Permalink to &quot;二、创建系统托盘&quot;">​</a></h2><div class="language-rust vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">use</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">tauri</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">SystemTray</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> tray </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">SystemTray</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">new</span><span style="color:#E1E4E8;">();</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">use</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">tauri</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">SystemTray</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">let</span><span style="color:#24292E;"> tray </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SystemTray</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">new</span><span style="color:#24292E;">();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="三、配置系统托盘菜单" tabindex="-1">三、配置系统托盘菜单 <a class="header-anchor" href="#三、配置系统托盘菜单" aria-label="Permalink to &quot;三、配置系统托盘菜单&quot;">​</a></h2><div class="language-rust vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">use</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">tauri</span><span style="color:#F97583;">::</span><span style="color:#E1E4E8;">{</span><span style="color:#B392F0;">CustomMenuItem</span><span style="color:#E1E4E8;">, </span><span style="color:#B392F0;">SystemTrayMenu</span><span style="color:#E1E4E8;">, </span><span style="color:#B392F0;">SystemTrayMenuItem</span><span style="color:#E1E4E8;">};</span></span>
<span class="line"><span style="color:#6A737D;">// here \`&quot;quit&quot;.to_string()\` defines the menu item id, and the second parameter is the menu item label.</span></span>
<span class="line"><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> quit </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">CustomMenuItem</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">new</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;quit&quot;</span><span style="color:#F97583;">.</span><span style="color:#B392F0;">to_string</span><span style="color:#E1E4E8;">(), </span><span style="color:#9ECBFF;">&quot;Quit&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> hide </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">CustomMenuItem</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">new</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;hide&quot;</span><span style="color:#F97583;">.</span><span style="color:#B392F0;">to_string</span><span style="color:#E1E4E8;">(), </span><span style="color:#9ECBFF;">&quot;Hide&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> tray_menu </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">SystemTrayMenu</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">new</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">.</span><span style="color:#B392F0;">add_item</span><span style="color:#E1E4E8;">(quit)</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">.</span><span style="color:#B392F0;">add_native_item</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">SystemTrayMenuItem</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">Separator</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">.</span><span style="color:#B392F0;">add_item</span><span style="color:#E1E4E8;">(hide);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">use</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">tauri</span><span style="color:#D73A49;">::</span><span style="color:#24292E;">{</span><span style="color:#6F42C1;">CustomMenuItem</span><span style="color:#24292E;">, </span><span style="color:#6F42C1;">SystemTrayMenu</span><span style="color:#24292E;">, </span><span style="color:#6F42C1;">SystemTrayMenuItem</span><span style="color:#24292E;">};</span></span>
<span class="line"><span style="color:#6A737D;">// here \`&quot;quit&quot;.to_string()\` defines the menu item id, and the second parameter is the menu item label.</span></span>
<span class="line"><span style="color:#D73A49;">let</span><span style="color:#24292E;"> quit </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">CustomMenuItem</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">new</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;quit&quot;</span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">to_string</span><span style="color:#24292E;">(), </span><span style="color:#032F62;">&quot;Quit&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#D73A49;">let</span><span style="color:#24292E;"> hide </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">CustomMenuItem</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">new</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;hide&quot;</span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">to_string</span><span style="color:#24292E;">(), </span><span style="color:#032F62;">&quot;Hide&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#D73A49;">let</span><span style="color:#24292E;"> tray_menu </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SystemTrayMenu</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">new</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">add_item</span><span style="color:#24292E;">(quit)</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">add_native_item</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">SystemTrayMenuItem</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">Separator</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">add_item</span><span style="color:#24292E;">(hide);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>加托盘菜单添加到<code>SystemTray</code>实例上</p><div class="language-rust vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> tray </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">SystemTray</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">new</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">.</span><span style="color:#B392F0;">with_menu</span><span style="color:#E1E4E8;">(tray_menu);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">let</span><span style="color:#24292E;"> tray </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SystemTray</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">new</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">with_menu</span><span style="color:#24292E;">(tray_menu);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="四、配置系统应用托盘" tabindex="-1">四、配置系统应用托盘 <a class="header-anchor" href="#四、配置系统应用托盘" aria-label="Permalink to &quot;四、配置系统应用托盘&quot;">​</a></h2><div class="language-rust vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">use</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">tauri</span><span style="color:#F97583;">::</span><span style="color:#E1E4E8;">{</span><span style="color:#B392F0;">CustomMenuItem</span><span style="color:#E1E4E8;">, </span><span style="color:#B392F0;">SystemTray</span><span style="color:#E1E4E8;">, </span><span style="color:#B392F0;">SystemTrayMenu</span><span style="color:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> tray_menu </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">SystemTrayMenu</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">new</span><span style="color:#E1E4E8;">();</span><span style="color:#6A737D;"> // insert the menu items here</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> system_tray </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">SystemTray</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">new</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">.</span><span style="color:#B392F0;">with_menu</span><span style="color:#E1E4E8;">(tray_menu);</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">tauri</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">Builder</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">default</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">.</span><span style="color:#B392F0;">system_tray</span><span style="color:#E1E4E8;">(system_tray)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">.</span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">tauri</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">generate_context!</span><span style="color:#E1E4E8;">())</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">.</span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;error while running tauri application&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">use</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">tauri</span><span style="color:#D73A49;">::</span><span style="color:#24292E;">{</span><span style="color:#6F42C1;">CustomMenuItem</span><span style="color:#24292E;">, </span><span style="color:#6F42C1;">SystemTray</span><span style="color:#24292E;">, </span><span style="color:#6F42C1;">SystemTrayMenu</span><span style="color:#24292E;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> tray_menu </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SystemTrayMenu</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">new</span><span style="color:#24292E;">();</span><span style="color:#6A737D;"> // insert the menu items here</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> system_tray </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SystemTray</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">new</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">with_menu</span><span style="color:#24292E;">(tray_menu);</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">tauri</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">Builder</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">default</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">system_tray</span><span style="color:#24292E;">(system_tray)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">tauri</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">generate_context!</span><span style="color:#24292E;">())</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;error while running tauri application&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="五、监听托盘菜单点击事件" tabindex="-1">五、监听托盘菜单点击事件 <a class="header-anchor" href="#五、监听托盘菜单点击事件" aria-label="Permalink to &quot;五、监听托盘菜单点击事件&quot;">​</a></h2><p>点击事件有：</p><ul><li>左键单击</li><li>右键单击</li><li>双击</li><li>点击菜单项</li></ul><div class="language-rust vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">use</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">tauri</span><span style="color:#F97583;">::</span><span style="color:#E1E4E8;">{</span><span style="color:#B392F0;">CustomMenuItem</span><span style="color:#E1E4E8;">, </span><span style="color:#B392F0;">SystemTray</span><span style="color:#E1E4E8;">, </span><span style="color:#B392F0;">SystemTrayMenu</span><span style="color:#E1E4E8;">, </span><span style="color:#B392F0;">SystemTrayEvent</span><span style="color:#E1E4E8;">};</span></span>
<span class="line"><span style="color:#F97583;">use</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">tauri</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">Manager</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> tray_menu </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">SystemTrayMenu</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">new</span><span style="color:#E1E4E8;">();</span><span style="color:#6A737D;"> // insert the menu items here</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">tauri</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">Builder</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">default</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">.</span><span style="color:#B392F0;">system_tray</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">SystemTray</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">new</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">.</span><span style="color:#B392F0;">with_menu</span><span style="color:#E1E4E8;">(tray_menu))</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">.</span><span style="color:#B392F0;">on_system_tray_event</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">app, event</span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">match</span><span style="color:#E1E4E8;"> event {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">SystemTrayEvent</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">LeftClick</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        position</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> _,</span></span>
<span class="line"><span style="color:#E1E4E8;">        size</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> _,</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">..</span></span>
<span class="line"><span style="color:#E1E4E8;">      } </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">println!</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;system tray received a left click&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">      }</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">SystemTrayEvent</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">RightClick</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        position</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> _,</span></span>
<span class="line"><span style="color:#E1E4E8;">        size</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> _,</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">..</span></span>
<span class="line"><span style="color:#E1E4E8;">      } </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">println!</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;system tray received a right click&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">      }</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">SystemTrayEvent</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">DoubleClick</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        position</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> _,</span></span>
<span class="line"><span style="color:#E1E4E8;">        size</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> _,</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">..</span></span>
<span class="line"><span style="color:#E1E4E8;">      } </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">println!</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;system tray received a double click&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">      }</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">SystemTrayEvent</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">MenuItemClick</span><span style="color:#E1E4E8;"> { id, </span><span style="color:#F97583;">..</span><span style="color:#E1E4E8;"> } </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">match</span><span style="color:#E1E4E8;"> id</span><span style="color:#F97583;">.</span><span style="color:#B392F0;">as_str</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#9ECBFF;">&quot;quit&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#B392F0;">std</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">process</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">exit</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">          }</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#9ECBFF;">&quot;hide&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> window </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> app</span><span style="color:#F97583;">.</span><span style="color:#B392F0;">get_window</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;main&quot;</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">.</span><span style="color:#B392F0;">unwrap</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            window</span><span style="color:#F97583;">.</span><span style="color:#B392F0;">hide</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">.</span><span style="color:#B392F0;">unwrap</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">          }</span></span>
<span class="line"><span style="color:#E1E4E8;">          _ </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {}</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">      }</span></span>
<span class="line"><span style="color:#E1E4E8;">      _ </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {}</span></span>
<span class="line"><span style="color:#E1E4E8;">    })</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">.</span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">tauri</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">generate_context!</span><span style="color:#E1E4E8;">())</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">.</span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;error while running tauri application&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">use</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">tauri</span><span style="color:#D73A49;">::</span><span style="color:#24292E;">{</span><span style="color:#6F42C1;">CustomMenuItem</span><span style="color:#24292E;">, </span><span style="color:#6F42C1;">SystemTray</span><span style="color:#24292E;">, </span><span style="color:#6F42C1;">SystemTrayMenu</span><span style="color:#24292E;">, </span><span style="color:#6F42C1;">SystemTrayEvent</span><span style="color:#24292E;">};</span></span>
<span class="line"><span style="color:#D73A49;">use</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">tauri</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">Manager</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> tray_menu </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SystemTrayMenu</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">new</span><span style="color:#24292E;">();</span><span style="color:#6A737D;"> // insert the menu items here</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">tauri</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">Builder</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">default</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">system_tray</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">SystemTray</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">new</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">with_menu</span><span style="color:#24292E;">(tray_menu))</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">on_system_tray_event</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">|</span><span style="color:#24292E;">app, event</span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">match</span><span style="color:#24292E;"> event {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">SystemTrayEvent</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">LeftClick</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        position</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> _,</span></span>
<span class="line"><span style="color:#24292E;">        size</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> _,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">..</span></span>
<span class="line"><span style="color:#24292E;">      } </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">println!</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;system tray received a left click&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">      }</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">SystemTrayEvent</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">RightClick</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        position</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> _,</span></span>
<span class="line"><span style="color:#24292E;">        size</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> _,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">..</span></span>
<span class="line"><span style="color:#24292E;">      } </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">println!</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;system tray received a right click&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">      }</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">SystemTrayEvent</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">DoubleClick</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        position</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> _,</span></span>
<span class="line"><span style="color:#24292E;">        size</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> _,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">..</span></span>
<span class="line"><span style="color:#24292E;">      } </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">println!</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;system tray received a double click&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">      }</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">SystemTrayEvent</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">MenuItemClick</span><span style="color:#24292E;"> { id, </span><span style="color:#D73A49;">..</span><span style="color:#24292E;"> } </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">match</span><span style="color:#24292E;"> id</span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">as_str</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#032F62;">&quot;quit&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">std</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">process</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">exit</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">          }</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#032F62;">&quot;hide&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> window </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> app</span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">get_window</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;main&quot;</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">unwrap</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            window</span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">hide</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">unwrap</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">          }</span></span>
<span class="line"><span style="color:#24292E;">          _ </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {}</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">      }</span></span>
<span class="line"><span style="color:#24292E;">      _ </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {}</span></span>
<span class="line"><span style="color:#24292E;">    })</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">tauri</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">generate_context!</span><span style="color:#24292E;">())</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;error while running tauri application&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><h2 id="六、更新系统托盘" tabindex="-1">六、更新系统托盘 <a class="header-anchor" href="#六、更新系统托盘" aria-label="Permalink to &quot;六、更新系统托盘&quot;">​</a></h2><p><code>AppHandle</code>结构里有一个<code>tray_handle</code>方法，返回一个<code>handle</code>可以实现更新托盘图标及菜单项的名称</p><h3 id="_1-更新菜单项名称" tabindex="-1">1. 更新菜单项名称 <a class="header-anchor" href="#_1-更新菜单项名称" aria-label="Permalink to &quot;1. 更新菜单项名称&quot;">​</a></h3><div class="language-rust vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">use</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">tauri</span><span style="color:#F97583;">::</span><span style="color:#E1E4E8;">{</span><span style="color:#B392F0;">CustomMenuItem</span><span style="color:#E1E4E8;">, </span><span style="color:#B392F0;">SystemTray</span><span style="color:#E1E4E8;">, </span><span style="color:#B392F0;">SystemTrayMenu</span><span style="color:#E1E4E8;">, </span><span style="color:#B392F0;">SystemTrayEvent</span><span style="color:#E1E4E8;">};</span></span>
<span class="line"><span style="color:#F97583;">use</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">tauri</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">Manager</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> tray_menu </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">SystemTrayMenu</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">new</span><span style="color:#E1E4E8;">();</span><span style="color:#6A737D;"> // insert the menu items here</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">tauri</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">Builder</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">default</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">.</span><span style="color:#B392F0;">system_tray</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">SystemTray</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">new</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">.</span><span style="color:#B392F0;">with_menu</span><span style="color:#E1E4E8;">(tray_menu))</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">.</span><span style="color:#B392F0;">on_system_tray_event</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">app, event</span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">match</span><span style="color:#E1E4E8;"> event {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">SystemTrayEvent</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">MenuItemClick</span><span style="color:#E1E4E8;"> { id, </span><span style="color:#F97583;">..</span><span style="color:#E1E4E8;"> } </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#6A737D;">        // get a handle to the clicked menu item</span></span>
<span class="line"><span style="color:#6A737D;">        // note that \`tray_handle\` can be called anywhere,</span></span>
<span class="line"><span style="color:#6A737D;">        // just get an \`AppHandle\` instance with \`app.handle()\` on the setup hook</span></span>
<span class="line"><span style="color:#6A737D;">        // and move it to another function or thread</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> item_handle </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> app</span><span style="color:#F97583;">.</span><span style="color:#B392F0;">tray_handle</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">.</span><span style="color:#B392F0;">get_item</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">id);</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">match</span><span style="color:#E1E4E8;"> id</span><span style="color:#F97583;">.</span><span style="color:#B392F0;">as_str</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#9ECBFF;">&quot;hide&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> window </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> app</span><span style="color:#F97583;">.</span><span style="color:#B392F0;">get_window</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;main&quot;</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">.</span><span style="color:#B392F0;">unwrap</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">            window</span><span style="color:#F97583;">.</span><span style="color:#B392F0;">hide</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">.</span><span style="color:#B392F0;">unwrap</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#6A737D;">            // you can also \`set_selected\`, \`set_enabled\` and \`set_native_image\` (macOS only).</span></span>
<span class="line"><span style="color:#E1E4E8;">            item_handle</span><span style="color:#F97583;">.</span><span style="color:#B392F0;">set_title</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Show&quot;</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">.</span><span style="color:#B392F0;">unwrap</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">          }</span></span>
<span class="line"><span style="color:#E1E4E8;">          _ </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {}</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">      }</span></span>
<span class="line"><span style="color:#E1E4E8;">      _ </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {}</span></span>
<span class="line"><span style="color:#E1E4E8;">    })</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">.</span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">tauri</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">generate_context!</span><span style="color:#E1E4E8;">())</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">.</span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;error while running tauri application&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">use</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">tauri</span><span style="color:#D73A49;">::</span><span style="color:#24292E;">{</span><span style="color:#6F42C1;">CustomMenuItem</span><span style="color:#24292E;">, </span><span style="color:#6F42C1;">SystemTray</span><span style="color:#24292E;">, </span><span style="color:#6F42C1;">SystemTrayMenu</span><span style="color:#24292E;">, </span><span style="color:#6F42C1;">SystemTrayEvent</span><span style="color:#24292E;">};</span></span>
<span class="line"><span style="color:#D73A49;">use</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">tauri</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">Manager</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">fn</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> tray_menu </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SystemTrayMenu</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">new</span><span style="color:#24292E;">();</span><span style="color:#6A737D;"> // insert the menu items here</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">tauri</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">Builder</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">default</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">system_tray</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">SystemTray</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">new</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">with_menu</span><span style="color:#24292E;">(tray_menu))</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">on_system_tray_event</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">|</span><span style="color:#24292E;">app, event</span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">match</span><span style="color:#24292E;"> event {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">SystemTrayEvent</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">MenuItemClick</span><span style="color:#24292E;"> { id, </span><span style="color:#D73A49;">..</span><span style="color:#24292E;"> } </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#6A737D;">        // get a handle to the clicked menu item</span></span>
<span class="line"><span style="color:#6A737D;">        // note that \`tray_handle\` can be called anywhere,</span></span>
<span class="line"><span style="color:#6A737D;">        // just get an \`AppHandle\` instance with \`app.handle()\` on the setup hook</span></span>
<span class="line"><span style="color:#6A737D;">        // and move it to another function or thread</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> item_handle </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> app</span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">tray_handle</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">get_item</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">id);</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">match</span><span style="color:#24292E;"> id</span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">as_str</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#032F62;">&quot;hide&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> window </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> app</span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">get_window</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;main&quot;</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">unwrap</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            window</span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">hide</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">unwrap</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#6A737D;">            // you can also \`set_selected\`, \`set_enabled\` and \`set_native_image\` (macOS only).</span></span>
<span class="line"><span style="color:#24292E;">            item_handle</span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">set_title</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Show&quot;</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">unwrap</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">          }</span></span>
<span class="line"><span style="color:#24292E;">          _ </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {}</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">      }</span></span>
<span class="line"><span style="color:#24292E;">      _ </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {}</span></span>
<span class="line"><span style="color:#24292E;">    })</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">tauri</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">generate_context!</span><span style="color:#24292E;">())</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;error while running tauri application&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h3 id="_2-更新托盘图标" tabindex="-1">2.更新托盘图标 <a class="header-anchor" href="#_2-更新托盘图标" aria-label="Permalink to &quot;2.更新托盘图标&quot;">​</a></h3><div class="language-rust vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">app</span><span style="color:#F97583;">.</span><span style="color:#B392F0;">tray_handle</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">.</span><span style="color:#B392F0;">set_icon</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">tauri</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">Icon</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">Raw</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">include_bytes!</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;../path/to/myicon.ico&quot;</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">.</span><span style="color:#B392F0;">to_vec</span><span style="color:#E1E4E8;">()))</span><span style="color:#F97583;">.</span><span style="color:#B392F0;">unwrap</span><span style="color:#E1E4E8;">();</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">app</span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">tray_handle</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">set_icon</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">tauri</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">Icon</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">Raw</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">include_bytes!</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;../path/to/myicon.ico&quot;</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">to_vec</span><span style="color:#24292E;">()))</span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">unwrap</span><span style="color:#24292E;">();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="七、设置应用后台运行" tabindex="-1">七、设置应用后台运行 <a class="header-anchor" href="#七、设置应用后台运行" aria-label="Permalink to &quot;七、设置应用后台运行&quot;">​</a></h2><p>默认情况下，关闭所有窗口后应用会被关闭，如果想要应用在后台继续运行，可以使用<code>api.prevent_close()</code>方法实现</p><div class="language-rust vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">tauri</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">Builder</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">default</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">.</span><span style="color:#B392F0;">build</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">tauri</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">generate_context!</span><span style="color:#E1E4E8;">())</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">.</span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;error while building tauri application&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">.</span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">_app_handle, event</span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">match</span><span style="color:#E1E4E8;"> event {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">tauri</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">RunEvent</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">ExitRequested</span><span style="color:#E1E4E8;"> { api, </span><span style="color:#F97583;">..</span><span style="color:#E1E4E8;"> } </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">      api</span><span style="color:#F97583;">.</span><span style="color:#B392F0;">prevent_exit</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    _ </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {}</span></span>
<span class="line"><span style="color:#E1E4E8;">  });</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">tauri</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">Builder</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">default</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">build</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">tauri</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">generate_context!</span><span style="color:#24292E;">())</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;error while building tauri application&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">|</span><span style="color:#24292E;">_app_handle, event</span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">match</span><span style="color:#24292E;"> event {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">tauri</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">RunEvent</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">ExitRequested</span><span style="color:#24292E;"> { api, </span><span style="color:#D73A49;">..</span><span style="color:#24292E;"> } </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">      api</span><span style="color:#D73A49;">.</span><span style="color:#6F42C1;">prevent_exit</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    _ </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {}</span></span>
<span class="line"><span style="color:#24292E;">  });</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div>`,27),e=[o];function t(r,c,y,E,i,u){return n(),a("div",null,e)}const d=s(p,[["render",t]]);export{m as __pageData,d as default};
